}
else if (value_age <= list_quant["75%"]){
age_num[i] <- "39-47"
} else {
age_num[i] <- "48-100+"
}
}
df$age_num <- age_num
# Do the multiple MCA
for (col1 in column_mca){
pos1 <- match(col1, column_mca)
for (col2 in column_mca){
pos2 <- match(col2, column_mca)
if (pos1 >= pos2){
next
}
# Isolate columns
cat(col1, col2, "\n")
col_compare <- c(col1, col2)
df_famd <- df[col_compare]
df_famd <- na.omit(df_famd)
# Do the MCA
res_famd <- MCA(df_famd, ncp = ndim_mca, graph = FALSE)
#print(summary(res_famd))
plot.MCA(res_famd, choix="ind") +
ggtitle("test")
# ggsave("famd_var.jpeg", device = "jpeg", dpi = 500)
break
}
break
}
# # Plot cumulative variance
# eigen <- as.data.frame(res_famd$eig)
# rownames(eigen) <- NULL
# colnames(eigen) <- c("eigenvalue",  "percentage_of_variance", "cumulative_percentage_of_variance")
# eigen["number"] <- as.integer(rownames(eigen))
#
# ggplot(data = eigen) +
#   geom_point(aes(x = number, y = cumulative_percentage_of_variance)) +
#   xlab('Nombre de facteurs conservés') +
#   ylab('Variance cumulée (%)')
# # ggsave("famd_cumul.jpeg", device = "jpeg", dpi = 500)
# Select only usefull columns
column_mca <- c("age_num", "job", "marital", "education", "housing", "loan")
ndim_mca <- 2
# Change age into number
list_quant <- quantile(df[,"age"], probs = c(0.25, 0.5, 0.75))
print(list_quant)
age_num <- matrix(-1, nrow = nrow(df), ncol = 1)
for (i in 1:nrow(df)){
value_age <- df[i,"age"]
if (value_age <= list_quant["25%"]){
age_num[i] <- "0-32"
}
else if(value_age <= list_quant["50%"]){
age_num[i] <- "33-38"
}
else if (value_age <= list_quant["75%"]){
age_num[i] <- "39-47"
} else {
age_num[i] <- "48-100+"
}
}
df$age_num <- age_num
# Do the multiple MCA
for (col1 in column_mca){
pos1 <- match(col1, column_mca)
for (col2 in column_mca){
pos2 <- match(col2, column_mca)
if (pos1 >= pos2){
next
}
# Isolate columns
cat(col1, col2, "\n")
col_compare <- c(col1, col2)
df_famd <- df[col_compare]
df_famd <- na.omit(df_famd)
# Do the MCA
res_famd <- MCA(df_famd, ncp = ndim_mca, graph = FALSE)
#print(summary(res_famd))
plot(res_famd, choix="ind") +
ggtitle("test")
# ggsave("famd_var.jpeg", device = "jpeg", dpi = 500)
break
}
break
}
# # Plot cumulative variance
# eigen <- as.data.frame(res_famd$eig)
# rownames(eigen) <- NULL
# colnames(eigen) <- c("eigenvalue",  "percentage_of_variance", "cumulative_percentage_of_variance")
# eigen["number"] <- as.integer(rownames(eigen))
#
# ggplot(data = eigen) +
#   geom_point(aes(x = number, y = cumulative_percentage_of_variance)) +
#   xlab('Nombre de facteurs conservés') +
#   ylab('Variance cumulée (%)')
# # ggsave("famd_cumul.jpeg", device = "jpeg", dpi = 500)
# Select only usefull columns
column_mca <- c("age_num", "job", "marital", "education", "housing", "loan")
ndim_mca <- 2
# Change age into number
list_quant <- quantile(df[,"age"], probs = c(0.25, 0.5, 0.75))
print(list_quant)
age_num <- matrix(-1, nrow = nrow(df), ncol = 1)
for (i in 1:nrow(df)){
value_age <- df[i,"age"]
if (value_age <= list_quant["25%"]){
age_num[i] <- "0-32"
}
else if(value_age <= list_quant["50%"]){
age_num[i] <- "33-38"
}
else if (value_age <= list_quant["75%"]){
age_num[i] <- "39-47"
} else {
age_num[i] <- "48-100+"
}
}
df$age_num <- age_num
# Do the multiple MCA
for (col1 in column_mca){
pos1 <- match(col1, column_mca)
for (col2 in column_mca){
pos2 <- match(col2, column_mca)
if (pos1 >= pos2){
next
}
# Isolate columns
cat(col1, col2, "\n")
col_compare <- c(col1, col2)
df_famd <- df[col_compare]
df_famd <- na.omit(df_famd)
# Do the MCA
res_famd <- MCA(df_famd, ncp = ndim_mca, graph = FALSE)
#print(summary(res_famd))
plot(res_famd, choix="var") +
ggtitle("test")
# ggsave("famd_var.jpeg", device = "jpeg", dpi = 500)
break
}
break
}
# # Plot cumulative variance
# eigen <- as.data.frame(res_famd$eig)
# rownames(eigen) <- NULL
# colnames(eigen) <- c("eigenvalue",  "percentage_of_variance", "cumulative_percentage_of_variance")
# eigen["number"] <- as.integer(rownames(eigen))
#
# ggplot(data = eigen) +
#   geom_point(aes(x = number, y = cumulative_percentage_of_variance)) +
#   xlab('Nombre de facteurs conservés') +
#   ylab('Variance cumulée (%)')
# # ggsave("famd_cumul.jpeg", device = "jpeg", dpi = 500)
# Select only usefull columns
column_mca <- c("age_num", "job", "marital", "education", "housing", "loan")
ndim_mca <- 2
# Change age into number
list_quant <- quantile(df[,"age"], probs = c(0.25, 0.5, 0.75))
print(list_quant)
age_num <- matrix(-1, nrow = nrow(df), ncol = 1)
for (i in 1:nrow(df)){
value_age <- df[i,"age"]
if (value_age <= list_quant["25%"]){
age_num[i] <- "0-32"
}
else if(value_age <= list_quant["50%"]){
age_num[i] <- "33-38"
}
else if (value_age <= list_quant["75%"]){
age_num[i] <- "39-47"
} else {
age_num[i] <- "48-100+"
}
}
df$age_num <- age_num
# Do the multiple MCA
for (col1 in column_mca){
pos1 <- match(col1, column_mca)
for (col2 in column_mca){
pos2 <- match(col2, column_mca)
if (pos1 >= pos2){
next
}
# Isolate columns
cat(col1, col2, "\n")
col_compare <- c(col1, col2)
df_famd <- df[col_compare]
df_famd <- na.omit(df_famd)
# Do the MCA
res_famd <- MCA(df_famd, ncp = ndim_mca, graph = FALSE)
#print(summary(res_famd))
plot(res_famd, choix="var")
# ggsave("famd_var.jpeg", device = "jpeg", dpi = 500)
break
}
break
}
# # Plot cumulative variance
# eigen <- as.data.frame(res_famd$eig)
# rownames(eigen) <- NULL
# colnames(eigen) <- c("eigenvalue",  "percentage_of_variance", "cumulative_percentage_of_variance")
# eigen["number"] <- as.integer(rownames(eigen))
#
# ggplot(data = eigen) +
#   geom_point(aes(x = number, y = cumulative_percentage_of_variance)) +
#   xlab('Nombre de facteurs conservés') +
#   ylab('Variance cumulée (%)')
# # ggsave("famd_cumul.jpeg", device = "jpeg", dpi = 500)
# Select only usefull columns
column_mca <- c("age_num", "job", "marital", "education", "housing", "loan")
ndim_mca <- 2
# Change age into number
list_quant <- quantile(df[,"age"], probs = c(0.25, 0.5, 0.75))
print(list_quant)
age_num <- matrix(-1, nrow = nrow(df), ncol = 1)
for (i in 1:nrow(df)){
value_age <- df[i,"age"]
if (value_age <= list_quant["25%"]){
age_num[i] <- "0-32"
}
else if(value_age <= list_quant["50%"]){
age_num[i] <- "33-38"
}
else if (value_age <= list_quant["75%"]){
age_num[i] <- "39-47"
} else {
age_num[i] <- "48-100+"
}
}
df$age_num <- age_num
# Do the multiple MCA
for (col1 in column_mca){
pos1 <- match(col1, column_mca)
for (col2 in column_mca){
pos2 <- match(col2, column_mca)
if (pos1 >= pos2){
next
}
# Isolate columns
cat(col1, col2, "\n")
col_compare <- c(col1, col2)
df_famd <- df[col_compare]
df_famd <- na.omit(df_famd)
# Do the MCA
res_famd <- MCA(df_famd, ncp = ndim_mca, graph = TRUE)
plot(res_famd, choix="var")
# ggsave("famd_var.jpeg", device = "jpeg", dpi = 500)
break
}
break
}
# # Plot cumulative variance
# eigen <- as.data.frame(res_famd$eig)
# rownames(eigen) <- NULL
# colnames(eigen) <- c("eigenvalue",  "percentage_of_variance", "cumulative_percentage_of_variance")
# eigen["number"] <- as.integer(rownames(eigen))
#
# ggplot(data = eigen) +
#   geom_point(aes(x = number, y = cumulative_percentage_of_variance)) +
#   xlab('Nombre de facteurs conservés') +
#   ylab('Variance cumulée (%)')
# # ggsave("famd_cumul.jpeg", device = "jpeg", dpi = 500)
# Select only usefull columns
column_mca <- c("age_num", "job", "marital", "education", "housing", "loan")
ndim_mca <- 2
# Change age into number
list_quant <- quantile(df[,"age"], probs = c(0.25, 0.5, 0.75))
print(list_quant)
age_num <- matrix(-1, nrow = nrow(df), ncol = 1)
for (i in 1:nrow(df)){
value_age <- df[i,"age"]
if (value_age <= list_quant["25%"]){
age_num[i] <- "0-32"
}
else if(value_age <= list_quant["50%"]){
age_num[i] <- "33-38"
}
else if (value_age <= list_quant["75%"]){
age_num[i] <- "39-47"
} else {
age_num[i] <- "48-100+"
}
}
df$age_num <- age_num
# Do the multiple MCA
for (col1 in column_mca){
pos1 <- match(col1, column_mca)
for (col2 in column_mca){
pos2 <- match(col2, column_mca)
if (pos1 >= pos2){
next
}
# Isolate columns
cat(col1, col2, "\n")
col_compare <- c(col1, col2)
df_famd <- df[col_compare]
df_famd <- na.omit(df_famd)
# Do the MCA
res_famd <- MCA(df_famd, ncp = ndim_mca, graph = TRUE)
plot(res_famd, choix="var")
# ggsave("famd_var.jpeg", device = "jpeg", dpi = 500)
}
break
}
# # Plot cumulative variance
# eigen <- as.data.frame(res_famd$eig)
# rownames(eigen) <- NULL
# colnames(eigen) <- c("eigenvalue",  "percentage_of_variance", "cumulative_percentage_of_variance")
# eigen["number"] <- as.integer(rownames(eigen))
#
# ggplot(data = eigen) +
#   geom_point(aes(x = number, y = cumulative_percentage_of_variance)) +
#   xlab('Nombre de facteurs conservés') +
#   ylab('Variance cumulée (%)')
# # ggsave("famd_cumul.jpeg", device = "jpeg", dpi = 500)
# Select only usefull columns
column_mca <- c("age_num", "job", "marital", "education", "housing", "loan")
ndim_mca <- 2
# Change age into number
list_quant <- quantile(df[,"age"], probs = c(0.25, 0.5, 0.75))
print(list_quant)
age_num <- matrix(-1, nrow = nrow(df), ncol = 1)
for (i in 1:nrow(df)){
value_age <- df[i,"age"]
if (value_age <= list_quant["25%"]){
age_num[i] <- "0-32"
}
else if(value_age <= list_quant["50%"]){
age_num[i] <- "33-38"
}
else if (value_age <= list_quant["75%"]){
age_num[i] <- "39-47"
} else {
age_num[i] <- "48-100+"
}
}
df$age_num <- age_num
# Do the multiple MCA
for (col1 in column_mca){
pos1 <- match(col1, column_mca)
for (col2 in column_mca){
pos2 <- match(col2, column_mca)
if (pos1 >= pos2){
next
}
# Isolate columns
cat(col1, col2, "\n")
col_compare <- c(col1, col2)
df_famd <- df[col_compare]
df_famd <- na.omit(df_famd)
# Do the MCA
res.famd <- MCA(df_famd, ncp = ndim_mca, graph = FALSE)
plot(res.famd, choix="var")
# ggsave("famd_var.jpeg", device = "jpeg", dpi = 500)
}
break
}
# # Plot cumulative variance
# eigen <- as.data.frame(res_famd$eig)
# rownames(eigen) <- NULL
# colnames(eigen) <- c("eigenvalue",  "percentage_of_variance", "cumulative_percentage_of_variance")
# eigen["number"] <- as.integer(rownames(eigen))
#
# ggplot(data = eigen) +
#   geom_point(aes(x = number, y = cumulative_percentage_of_variance)) +
#   xlab('Nombre de facteurs conservés') +
#   ylab('Variance cumulée (%)')
# # ggsave("famd_cumul.jpeg", device = "jpeg", dpi = 500)
# Select only usefull columns
column_mca <- c("age_num", "job", "marital", "education", "housing", "loan")
ndim_mca <- 2
# Change age into number
list_quant <- quantile(df[,"age"], probs = c(0.25, 0.5, 0.75))
print(list_quant)
age_num <- matrix(-1, nrow = nrow(df), ncol = 1)
for (i in 1:nrow(df)){
value_age <- df[i,"age"]
if (value_age <= list_quant["25%"]){
age_num[i] <- "0-32"
}
else if(value_age <= list_quant["50%"]){
age_num[i] <- "33-38"
}
else if (value_age <= list_quant["75%"]){
age_num[i] <- "39-47"
} else {
age_num[i] <- "48-100+"
}
}
df$age_num <- age_num
# Do the multiple MCA
for (col1 in column_mca){
pos1 <- match(col1, column_mca)
for (col2 in column_mca){
pos2 <- match(col2, column_mca)
if (pos1 >= pos2){
next
}
# Isolate columns
cat(col1, col2, "\n")
col_compare <- c(col1, col2)
df_famd <- df[col_compare]
df_famd <- na.omit(df_famd)
# Do the MCA
res.famd <- MCA(df_famd, ncp = ndim_mca, graph = FALSE)
plot(res.famd)
# ggsave("famd_var.jpeg", device = "jpeg", dpi = 500)
}
break
}
# # Plot cumulative variance
# eigen <- as.data.frame(res_famd$eig)
# rownames(eigen) <- NULL
# colnames(eigen) <- c("eigenvalue",  "percentage_of_variance", "cumulative_percentage_of_variance")
# eigen["number"] <- as.integer(rownames(eigen))
#
# ggplot(data = eigen) +
#   geom_point(aes(x = number, y = cumulative_percentage_of_variance)) +
#   xlab('Nombre de facteurs conservés') +
#   ylab('Variance cumulée (%)')
# # ggsave("famd_cumul.jpeg", device = "jpeg", dpi = 500)
# Select only usefull columns
column_mca <- c("age_num", "job", "marital", "education", "housing", "loan")
ndim_mca <- 2
# Change age into number
list_quant <- quantile(df[,"age"], probs = c(0.25, 0.5, 0.75))
print(list_quant)
age_num <- matrix(-1, nrow = nrow(df), ncol = 1)
for (i in 1:nrow(df)){
value_age <- df[i,"age"]
if (value_age <= list_quant["25%"]){
age_num[i] <- "0-32"
}
else if(value_age <= list_quant["50%"]){
age_num[i] <- "33-38"
}
else if (value_age <= list_quant["75%"]){
age_num[i] <- "39-47"
} else {
age_num[i] <- "48-100+"
}
}
df$age_num <- age_num
# Do the multiple MCA
for (col1 in column_mca){
pos1 <- match(col1, column_mca)
for (col2 in column_mca){
pos2 <- match(col2, column_mca)
if (pos1 >= pos2){
next
}
# Isolate columns
cat(col1, col2, "\n")
col_compare <- c(col1, col2)
df_famd <- df[col_compare]
df_famd <- na.omit(df_famd)
# Do the MCA
res.famd <- MCA(df_famd, ncp = ndim_mca, graph = TRUE)
}
break
}
# Select only usefull columns
column_mca <- c("age_num", "job", "marital", "education", "housing", "loan")
ndim_mca <- 2
# Change age into number
list_quant <- quantile(df[,"age"], probs = c(0.25, 0.5, 0.75))
print(list_quant)
age_num <- matrix(-1, nrow = nrow(df), ncol = 1)
for (i in 1:nrow(df)){
value_age <- df[i,"age"]
if (value_age <= list_quant["25%"]){
age_num[i] <- "0-32"
}
else if(value_age <= list_quant["50%"]){
age_num[i] <- "33-38"
}
else if (value_age <= list_quant["75%"]){
age_num[i] <- "39-47"
} else {
age_num[i] <- "48-100+"
}
}
df$age_num <- age_num
# Do the multiple MCA
for (col1 in column_mca){
pos1 <- match(col1, column_mca)
for (col2 in column_mca){
pos2 <- match(col2, column_mca)
if (pos1 >= pos2){
next
}
# Isolate columns
cat(col1, col2, "\n")
col_compare <- c(col1, col2)
df_famd <- df[col_compare]
df_famd <- na.omit(df_famd)
# Do the MCA
res.famd <- MCA(df_famd, ncp = ndim_mca, graph = TRUE)
}
}
# # Plot cumulative variance
# eigen <- as.data.frame(res_famd$eig)
# rownames(eigen) <- NULL
# colnames(eigen) <- c("eigenvalue",  "percentage_of_variance", "cumulative_percentage_of_variance")
# eigen["number"] <- as.integer(rownames(eigen))
#
# ggplot(data = eigen) +
#   geom_point(aes(x = number, y = cumulative_percentage_of_variance)) +
#   xlab('Nombre de facteurs conservés') +
#   ylab('Variance cumulée (%)')
# # ggsave("famd_cumul.jpeg", device = "jpeg", dpi = 500)
