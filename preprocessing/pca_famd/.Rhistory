library(ggplot2)
library(FactoMineR)
set.seed(42)
# Load data
df <- read.csv("bank_additional_clean.csv")
# Select only usefull columns
column_pca <- c("emp.var.rate", "cons.price.idx", "cons.conf.idx", "euribor3m", "nr.employed")
df_pca <- df[column_pca]
# Do the PCA
ndim_pca <- ncol(df_pca)
res_pca <- PCA(df_pca, ncp = ndim_pca, scale.unit = TRUE, graph = FALSE)
plot.PCA(res_pca, choix="var", title = "", cex=0.7)
# ggsave("pca.jpeg", device = "jpeg", dpi = 500)
# Select only usefull columns
column_pca <- c("emp.var.rate", "cons.price.idx", "cons.conf.idx", "euribor3m", "nr.employed")
df_pca <- df[column_pca]
# Do the PCA
ndim_pca <- ncol(df_pca)
res_pca <- PCA(df_pca, ncp = ndim_pca, scale.unit = TRUE, graph = FALSE)
plot.PCA(res_pca, choix="var", title = "", cex=0.7, autoLab=TRUE)
# Select only usefull columns
column_pca <- c("emp.var.rate", "cons.price.idx", "cons.conf.idx", "euribor3m", "nr.employed")
df_pca <- df[column_pca]
# Do the PCA
ndim_pca <- ncol(df_pca)
res_pca <- PCA(df_pca, ncp = ndim_pca, scale.unit = TRUE, graph = FALSE)
plot.PCA(res_pca, choix="var", title = "", cex=0.7, autoLab="yes")
# ggsave("pca.jpeg", device = "jpeg", dpi = 500)
# Select only usefull columns
column_pca <- c("emp.var.rate", "cons.price.idx", "cons.conf.idx", "euribor3m", "nr.employed")
df_pca <- df[column_pca]
# Do the PCA
ndim_pca <- ncol(df_pca)
res_pca <- PCA(df_pca, ncp = ndim_pca, scale.unit = TRUE, graph = FALSE)
plot.PCA(res_pca, choix="var", title = "", cex=0.7, autoLab="auto")
# ggsave("pca.jpeg", device = "jpeg", dpi = 500)
# Select only usefull columns
column_pca <- c("emp.var.rate", "cons.price.idx", "cons.conf.idx", "euribor3m", "nr.employed")
df_pca <- df[column_pca]
# Do the PCA
ndim_pca <- ncol(df_pca)
res_pca <- PCA(df_pca, ncp = ndim_pca, scale.unit = TRUE, graph = FALSE)
plot.PCA(res_pca, choix="var", title = "", cex=0.7, autoLab="yes")
ggsave("pca.jpeg", device = "jpeg", dpi = 500)
library(ggplot2)
library(FactoMineR)
set.seed(42)
# Load data
df <- read.csv("bank_additional_clean.csv")
# Select only usefull columns
column_pca <- c("emp.var.rate", "cons.price.idx", "cons.conf.idx", "euribor3m", "nr.employed")
df_pca <- df[column_pca]
# Do the PCA
ndim_pca <- ncol(df_pca)
res_pca <- PCA(df_pca, ncp = ndim_pca, scale.unit = TRUE, graph = FALSE)
plot.PCA(res_pca, choix="var", title = "", cex=0.7, autoLab="yes")
# ggsave("pca.jpeg", device = "jpeg", dpi = 500)
# Select only usefull columns
column_famd <- c("age", "job", "marital", "education", "housing", "loan")
df_famd <- df[column_famd]
df_famd <- na.omit(df_famd)
# Do the FAMD
ndim_famd <- 100
res_famd <- FAMD(df_famd, ncp = ndim_famd, graph = FALSE)
plot.FAMD(res_famd, choix="var", title = "")
# ggsave("famd_var.jpeg", device = "jpeg", dpi = 500)
# Plot cumulative variance
eigen <- as.data.frame(res_famd$eig)
rownames(eigen) <- NULL
colnames(eigen) <- c("eigenvalue",  "percentage_of_variance", "cumulative_percentage_of_variance")
eigen["number"] <- as.integer(rownames(eigen))
ggplot(data = eigen) +
geom_point(aes(x = number, y = cumulative_percentage_of_variance)) +
xlab('Nombre de facteurs conservés') +
ylab('Variance cumulée (%)')
ggsave("famd_cumul.jpeg", device = "jpeg", dpi = 500)
